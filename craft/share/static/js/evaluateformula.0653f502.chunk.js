"use strict";(self.webpackChunk_craft_internal_sharepage=self.webpackChunk_craft_internal_sharepage||[]).push([[868],{62397:(r,e,n)=>{n.r(e),n.d(e,{evaluateTable:()=>R});var t=n(77138),l=n(55688),o=n(15449);function u(r,e){return{column:{index:r,isAbsolute:!1},row:{index:e,isAbsolute:!1}}}function s(r){return Object.keys(r)}function a(r){return/^-?[0-9]+(\.[0-9]+)?$/.test(r)}function i(r){return r.reduce(((r,e)=>("number"===typeof e&&r.push(e),"string"===typeof e&&a(e)&&r.push(Number.parseFloat(e)),r)),[])}function c(r){return r.some((r=>r===(0,o.z3)(o.r0)))}const f=r=>r.flat(2),d=r=>function(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];const l=f(n);return c(l)?(0,o.z3)(o.r0):r(l)},p={ABOVE:r=>{let{coordinate:e,getCellRangeValue:n,tableHasColumnsHeader:t}=r;if(null==e)return null;const l=t?1:0;return n(u(e.column,l),u(e.column,e.row-1))},LEFT:r=>{let{coordinate:e,getCellRangeValue:n,tableHasRowsHeader:t}=r;if(null==e)return null;return n(u(t?1:0,e.row),u(e.column-1,e.row))},BELOW:r=>{let{coordinate:e,getCellRangeValue:n,tableData:t}=r;if(null==e)return null;const l=t.length-1;return n(u(e.column,e.row+1),u(e.column,l))},RIGHT:r=>{let{coordinate:e,getCellRangeValue:n,tableData:t}=r;if(null==e)return null;const l=(null===t||void 0===t?void 0:t[0].length)-1;return n(u(e.column+1,e.row),u(l,e.row))}};var w=n(86805);const h={ABS:d((r=>{let[e]=r;return(0,w.pdR)(e)})),AVERAGE:d((r=>(0,w.Gm6)(...i(r)))),COUNT:d((r=>(0,w.i2z)(...i(r)))),COUNTA:d((r=>(0,w.vK_)(...r))),INT:d((r=>{let[e]=r;return(0,w.I8o)(e)})),MAX:d((r=>(0,w.ZuR)(...i(r)))),MEDIAN:d((r=>(0,w.pX2)(...i(r)))),MIN:d((r=>(0,w.pHP)(...i(r)))),MODE:d((r=>(0,w.MbS)(...i(r)))),PRODUCT:d((r=>(0,w.Ax7)(...i(r)))),ROUND:(r,e)=>{if(Array.isArray(e))return(0,o.z3)(o.dH);const[n]=Array.isArray(r)?i(f(r)):i([r]);return null==n?(0,o.z3)(o.dH):c([n,e])?(0,o.z3)(o.r0):(0,w.D_t)(n,e)},SIGN:d((r=>{const[e]=i(r);return(0,w.AJN)(e)})),SUM:d((r=>(0,w.cjD)(...i(r))))},m=s(h),b={E:()=>Math.E,LN2:()=>Math.LN2,LN10:()=>Math.LN10,LOG2E:()=>Math.LOG2E,LOG10E:()=>Math.LOG10E,PI:()=>Math.PI,SQRT1_2:()=>Math.SQRT1_2,SQRT2:()=>Math.SQRT2},g=s(b),v=["+","/","^","*","-"];function A(r){const e=r.parser.yy.evaluateByOperator;r.parser.yy.evaluateByOperator=function(r,n){const t=e.bind(this);return v.includes(r)?((r,e,n)=>{if(!e.every((r=>"number"===typeof r||"string"===typeof r&&a(r)||"string"===typeof r&&""===r.trim())))throw new Error((0,o.z3)(o.dH));return n(r,e.map((r=>"string"===typeof r&&""===r.trim()?0:r)))})(r,n,t):"="===r?((r,e)=>{const[n,t]=e;return n==t})(0,n):t(r,n)}}const y=function(r,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const s=r.length,a=r[0].length;return(i,c,f)=>{if(""===i.trim()&&0===u)return{error:(0,o.z3)(o.ff),result:null};const d=new o.iX,w=(s,a)=>{if(null==r)return null;const i={column:a,row:s},c=(0,t.fc)(i);if(n.includes(c))throw new Error((0,o.z3)(o.r0));const f=r[s][a],d=(0,l.K)(f);if(!f||!d)return f;if(u>=100)throw new Error((0,o.z3)(o.r0));const p=y(r,e,[...n,c],u+1)((0,t.xD)(f),i),{result:w,error:h}=p;return null!==w&&void 0!==w?w:h},v=(r,e)=>{const n=[];if(e.row.index>s||e.column.index>a)return[[(0,o.z3)(o.r0)]];for(let t=r.row.index;t<=e.row.index;t++){const l=[];for(let n=r.column.index;n<=e.column.index;n++){const r=w(t,n);l.push(r)}n.push(l)}return n};d.on("callCellValue",((r,e)=>{if(r.column.isAbsolute||r.row.isAbsolute)throw new Error((0,o.z3)(o.jF));return e(w(r.row.index,r.column.index))})),d.on("callRangeValue",((r,e,n)=>{if(r.column.isAbsolute||r.row.isAbsolute||e.column.isAbsolute||e.row.isAbsolute)throw new Error((0,o.z3)(o.jF));return n(v(r,e))})),d.on("callVariable",((n,t)=>{var l;const o={coordinate:c,getCellRangeValue:v,tableData:r,tableHasColumnsHeader:e.tableHasColumnsHeader,tableHasRowsHeader:e.tableHasRowsHeader},u=n.toUpperCase(),s=p[u],a=null!==(l=null===s||void 0===s?void 0:s(o))&&void 0!==l?l:null;t(null===a?void 0:a)})),d.on("callFunction",((r,e,n)=>{const t=r.toUpperCase(),l=(r=>m.includes(r))(t),o=(r=>g.includes(r))(t);if(l||o)if(l){n((0,h[t])(...e))}else if(o){n((0,b[t])(...e))}else n(void 0);else n(void 0)})),A(d);const R=function(r){if("number"===typeof r.result&&null===r.error){const e=10**5,n=Math.round(r.result*e)/e;return{error:r.error,result:n}}return r}(function(r){if("string"===typeof r.result&&null!=(0,o.z3)(r.result))return{result:null,error:(0,o.z3)(r.result)};return r}(d.parse(i)));return null==R.error&&null!=f?{error:null,result:(0,t.Vl)((0,t.qq)(R.result),f)}:R}};const R=(r,e,n)=>{const o=y(r,n);return r.map(((r,n)=>r.map(((r,u)=>{const s=null===e||void 0===e?void 0:e[n][u];return(0,l.K)(r)?o((0,t.xD)(r),{column:u,row:n},s):{result:(0,t.Vl)(r,s),error:null}}))))}}}]);
//# sourceMappingURL=evaluateformula.0653f502.chunk.js.map