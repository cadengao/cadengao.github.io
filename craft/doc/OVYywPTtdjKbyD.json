{
  "schemaVersion": "1",
  "spaceId": "d8d537f0-b7d4-e6fe-0216-30e666a82048",
  "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
  "blocks": [
    {
      "id": "034F4D6C-1818-4ADC-987B-74EB2D0C7B68",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "这种调用约定类似__fastcall",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293039,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293039
    },
    {
      "id": "046D82E5-D432-451A-9037-464322FD79BB",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": ";====函数Main====\npush    4         ;第3个参数到最后一个参数压栈\npush    5    \npush    6    \nmov    edx,3   ;第1、第2个参数分别放入ecx、edx寄存器\nmov    ecx,2 \ncall    dword ptr ds:[00AD96B8h]  ;调用函数Sum，执行call的时候返回地址（即下面这条mov语句的地址）自动压栈了\nmov    dword ptr [ebp-0Ch],eax   ;将函数返回值设置到局部变量r中（函数调用结束返回值在eax寄存器中）\n\n;====函数Sum====\npush    ebp           ;保存原始ebp寄存器\nmov    ebp,esp     ;将当前栈指针保存在ebp中，后面使用ebp对参数和局部变量寻址\nsub    esp,8         ;分配两个局部变量\nmov    dword ptr [ebp-4],ecx         ;第1个参数放入局部变量\nmov    dword ptr [ebp-8],edx         ;第2个参数放入局部变量\n......     ;CLR的检查代码\nmov    eax,dword ptr [ebp-4]          ;a + b + c + d + e\nadd    eax,dword ptr [ebp-8]          ;第1个参数+第2个参数（2+3）\nadd    eax,dword ptr [ebp+10h]      ;+第3个参数（4）\nadd    eax,dword ptr [ebp+0Ch]      ;+第4个参数（5）\nadd    eax,dword ptr [ebp+8]          ;+第5个参数（6）\nmov    esp,ebp    ;恢复栈指针（局部变量被释放了）\npop    ebp          ;恢复原始的ebp寄存器值\nret    0Ch   ;函数返回. 1: 返回地址自动出 栈; 2: esp减去0Ch（12个字节），即从栈中清除调用参 数; 3: 返回值在eax寄存器中",
      "rawProperties": "{\"language\":\"other\"}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293028,
      "type": "code",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293029
    },
    {
      "id": "0D56D8B2-C4A7-4335-9004-1028BCFF021E",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "https://secure-res.craft.do/v2/5aWb66fVp68u13NidRaY5YuMMhLeAyvUnYQkBczAoUH9wvJA7DBYtt7zvF6Bpa869qWUBZJU4vbPouTXWiTp6czBLQkndZL5ScUoomApeLefETNxwipPi9JdNSCT4cvjcoRYeCnnLkSheR3EYHQ8WQ5oRpvMCuw7vmtKotkXepi8vTeo8W6BNf3hy6uBtv6Kk9P5eHyaupGS4xQd9Vr7yLSobH5QU2PN8tXp6NAcPtdVR4jtaJcvyF5jdZgQcmmv4WeMcW9RLmZBBnpBZV4PZKcdnKGwGmktshHNF1jZxLcySWC9E2",
      "pageStyleData": "{}",
      "rawProperties": "{\"aspectRatio\":\"1.2585365853658537\",\"fileExtension\":\"tiff\",\"fileName\":\"Image.tiff\",\"isPreviewImageUploaded\":\"true\",\"mimeType\":\"image/tiff\",\"previewImageWidth\":\"258.0\",\"primaryColor\":\"16777215\",\"rawDataSize\":\"162924\",\"rawUrl\":\"https://secure-res.craft.do/v2/5aWb66fVp68u13NidRaY5YuMMhLeAyvUnYQkBczAoUHA4ANcJrNJJHp7TNdudreBUpJ4Dyke2uY6kufKC25XjfskQ7j1H8Wpi6hPxR3zjCkda9eMrhoybiaxdNoBgxre64skEv9UKJe4G7LWKdFbftFY4qGu86BpamEtvBDpDK4EiYef1vZhf1y3SyZsCvX2JSyqdFJmSciEXnacm8P6kn1YKEhoEWxSyHFkPDK3eBBggfu89i8FtUoJ4Tpn87gPEVTb6xRWHeUdskVsR2DRz5j7yhs8gZqKXWebMazHNpLaS9JE7d/Image.jpg\",\"uploaded\":\"true\",\"url\":\"https://secure-res.craft.do/v2/5aWb66fVp68u13NidRaY5YuMMhLeAyvUnYQkBczAoUH9wvJA7DBYtt7zvF6Bpa869qWUBZJU4vbPouTXWiTp6czBLQkndZL5ScUoomApeLefETNxwipPi9JdNSCT4cvjcoRYeCnnLkSheR3EYHQ8WQ5oRpvMCuw7vmtKotkXepi8vTeo8W6BNf3hy6uBtv6Kk9P5eHyaupGS4xQd9Vr7yLSobH5QU2PN8tXp6NAcPtdVR4jtaJcvyF5jdZgQcmmv4WeMcW9RLmZBBnpBZV4PZKcdnKGwGmktshHNF1jZxLcySWC9E2/Image.jpg\"}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532364309,
      "type": "image",
      "style": "{\"decorations\":{},\"decorationStyles\":{},\"imageFillStyle\":\"scaleAspectFit\",\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532369466
    },
    {
      "id": "0E4343E5-56CB-446C-88B2-963AFBCD0A6B",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "Stack状态：",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293041,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293041
    },
    {
      "id": "11E7D047-9327-4997-B7A4-F54B76DBE797",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "https://secure-res.craft.do/v2/5aWb66fVp68u13NidRaY5YuMMhLeAyvUnYQkBczAoUH9wvJA7DBYtt7zvF6Bpa869qWUBZJU4vbPouTXWiTp6czBLQkndZL5ScUoomApeLefETNxwipPi9JdNSCT4cvjcoRYeCnnLkSheR3EYHQ8WQ5oSGP7fre7cMnJmVXttTH8dA64WnBngc9MpVfGx6XqTHfait6UubPjaip9jSJXwQdPbP3qN4tn4vseQ5c5kbhv2rquPN7jDJnjeoN1fXH6EdKQ8uSZt9b178PzjiKGzvjUnB34Zbvrovhh5VBjDuvnRy5HG4",
      "pageStyleData": "{}",
      "rawProperties": "{\"aspectRatio\":\"1.7527675276752768\",\"fileExtension\":\"tiff\",\"fileName\":\"Image.tiff\",\"isPreviewImageUploaded\":\"true\",\"mimeType\":\"image/tiff\",\"previewImageWidth\":\"475.0\",\"primaryColor\":\"16777215\",\"rawDataSize\":\"390438\",\"rawUrl\":\"https://secure-res.craft.do/v2/5aWb66fVp68u13NidRaY5YuMMhLeAyvUnYQkBczAoUHA4ANcJrNJJHp7TNdudreBUpJ4Dyke2uY6kufKC25XjfskQ7j1H8Wpi6hPxR3zjCkda9eMrhoybiaxdNoBgxre64skEv9UKJe4G7LWKdFbftFY4p7fU1hEaDVBVLnr4Qyt1RWBHHc7TNN7ckhDQW4jreiBMq4amz1g6wDhTayTLdkcJQhZFqZr33Bv1cnk7qUGs5YTjWAfZ17m7SyyRaMBC3SrE3QCBLFSGoajP5kzMrkSLb4sMwWGjBL1CvJJNgCgnT7GRq/Image.jpg\",\"uploaded\":\"true\",\"url\":\"https://secure-res.craft.do/v2/5aWb66fVp68u13NidRaY5YuMMhLeAyvUnYQkBczAoUH9wvJA7DBYtt7zvF6Bpa869qWUBZJU4vbPouTXWiTp6czBLQkndZL5ScUoomApeLefETNxwipPi9JdNSCT4cvjcoRYeCnnLkSheR3EYHQ8WQ5oSGP7fre7cMnJmVXttTH8dA64WnBngc9MpVfGx6XqTHfait6UubPjaip9jSJXwQdPbP3qN4tn4vseQ5c5kbhv2rquPN7jDJnjeoN1fXH6EdKQ8uSZt9b178PzjiKGzvjUnB34Zbvrovhh5VBjDuvnRy5HG4/Image.jpg\"}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532377683,
      "type": "image",
      "style": "{\"decorations\":{},\"decorationStyles\":{},\"imageFillStyle\":\"scaleAspectFit\",\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532384750
    },
    {
      "id": "1FAB7768-991E-407E-9FC3-B5BA58998D85",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "每个函数调用时，逻辑上在thread stack中会产生一个帧（stack frame），函数返回时对应的stack frame被释放掉。",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293023,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293024
    },
    {
      "id": "2162905F-EEF3-4713-8EAB-3C493DEBAAF8",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "https://secure-res.craft.do/v2/5aWb66fVp68u13NidRaY5YuMMhLeAyvUnYQkBczAoUH9wvJA7DBYtt7zvF6Bpa869qWUBZJU4vbPouTXWiTp6czBLQkndZL5ScUoomApeLefETNxwipPi9JdNSCT4cvjcoRYeCnnLkSheR3EYHQ8WQ5oRc8Wqs8axVba3FM1SzjDRKjS5X7z59JKK8zq6SQ1yfrzkkVpNS9NbBvQbAwmqJvrcFwxRdiSaoK916K2WHBASVvL4T2Vyx7ZivDn9wgBuK4oCi8nCRwm7JPvBBfJrWYcuusrFpdbVCAcdrjF6JcyBuE4Zi",
      "pageStyleData": "{}",
      "rawProperties": "{\"aspectRatio\":\"3.7666666666666666\",\"fileExtension\":\"tiff\",\"fileName\":\"Image.tiff\",\"isPreviewImageUploaded\":\"true\",\"mimeType\":\"image/tiff\",\"previewImageWidth\":\"452.0\",\"primaryColor\":\"14332635\",\"rawDataSize\":\"166974\",\"rawUrl\":\"https://secure-res.craft.do/v2/5aWb66fVp68u13NidRaY5YuMMhLeAyvUnYQkBczAoUHA4ANcJrNJJHp7TNdudreBUpJ4Dyke2uY6kufKC25XjfskQ7j1H8Wpi6hPxR3zjCkda9eMrhoybiaxdNoBgxre64skEv9UKJe4G7LWKdFbftFY58BSGBGDFeV8GH141eC4DCuKPkgpsxVURJo2pU8f2noDxAmeF9726ZLEea5eegbVsPdgZzqv8T9ztvvdKnrHqL4SgBPJBse24JWaRY3g1mPeeP8uPUSnGLWezpbQKUjFjniXVRL1D7jWLb3rVHbFhUFy8y/Image.jpg\",\"uploaded\":\"true\",\"url\":\"https://secure-res.craft.do/v2/5aWb66fVp68u13NidRaY5YuMMhLeAyvUnYQkBczAoUH9wvJA7DBYtt7zvF6Bpa869qWUBZJU4vbPouTXWiTp6czBLQkndZL5ScUoomApeLefETNxwipPi9JdNSCT4cvjcoRYeCnnLkSheR3EYHQ8WQ5oRc8Wqs8axVba3FM1SzjDRKjS5X7z59JKK8zq6SQ1yfrzkkVpNS9NbBvQbAwmqJvrcFwxRdiSaoK916K2WHBASVvL4T2Vyx7ZivDn9wgBuK4oCi8nCRwm7JPvBBfJrWYcuusrFpdbVCAcdrjF6JcyBuE4Zi/Image.jpg\"}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532340428,
      "type": "image",
      "style": "{\"decorations\":{},\"decorationStyles\":{},\"imageFillStyle\":\"scaleAspectFit\",\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532345768
    },
    {
      "id": "27CB311C-AC50-441B-BDBD-80FAD6B46E1E",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "JIT编译后主要汇编代码如下（其他的情况下汇编代码可能有所差别，但用这个简单函数大致看下栈的管理已经足够）：",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293027,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293028
    },
    {
      "id": "3F2AAA4E-2865-499C-89D6-F717DB76F620",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "定义局部变量以及省略掉的是额外代码，跟Sum函数业务无关",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293035,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"numbered\",\"textStyle\":\"body\",\"userDefinedListNumber\":4}",
      "blocks": [],
      "updated": 1687532293036
    },
    {
      "id": "46DB2ED5-11DC-4BE4-8BDB-661564BA78F2",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "恢复esp寄存器，这样函数Sum中所有的局部变量以及其他压栈操作全部释放出来",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293037,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"numbered\",\"textStyle\":\"body\",\"userDefinedListNumber\":6}",
      "blocks": [],
      "updated": 1687532293037
    },
    {
      "id": "4CE46333-8704-4841-BBEF-DE3C14C7091D",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "public static void Run(int i)\n{\n     int j = 9;\n     MyClass1 c = new MyClass1();\n     c.x = 8;\n     int result = Sum(i, 5, ref j, c);\n}\npublic static int Sum(int a, int b, ref int c, MyClass1 obj)\n{\n    int r = a + b + c + obj.x;\n    return r;\n}\npublic class MyClass1\n{\n    public int x;\n}",
      "rawProperties": "{\"language\":\"cs\"}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293040,
      "type": "code",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "pluginData": "{\"horizontalSizeClass\":\"regular\",\"pluginConfigurationData\":\"{\\\"themeId\\\":\\\"\\\"}\",\"pluginName\":\"codeBlock\",\"surfaceShadowOpacity\":0,\"verticalSizeClass\":\"regular\"}",
      "updated": 1687574298603
    },
    {
      "id": "533E5402-9EDD-4B50-AE26-AAFFF4CD9147",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "用个简单的函数查看执行时CLR对栈的处理情况：",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293025,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293025
    },
    {
      "id": "58756F7D-A7E9-40DF-8C15-763C04069956",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "调用者将第3、第4、第5个参数压栈，第1、第2个参数分别放入ecx、edx寄存器",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293033,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"numbered\",\"textStyle\":\"body\",\"userDefinedListNumber\":1}",
      "blocks": [],
      "updated": 1687532293034
    },
    {
      "id": "8C9B843D-9624-4281-95A9-FF1E310DC3E1",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "call指令调用函数Sum，并自动将函数返回地址压栈，代码跳转到函数Sum开始执行",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293034,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"numbered\",\"textStyle\":\"body\",\"userDefinedListNumber\":2}",
      "blocks": [],
      "updated": 1687532293034
    },
    {
      "id": "95DE32D7-F128-4C49-A33E-43CD0A852B02",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "除去pinned object等影响，heap中的内存分配很简单，一个指针记录heap中分配的起始地址，根据对象大小连续的分配内存。",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293022,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293022
    },
    {
      "id": "9D20A542-ACFA-400E-BBF7-F12656A279DA",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "ret指令执行函数返回，返回值在eax寄存器中，返回地址为call指令压栈的地址，返回地址自动出栈。0Ch指示处理器在函数返回时释放栈中12个字节，即由被调用者清除压栈的参数。函数返回之后，本次Sum调用的栈分配全部释放",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293038,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"numbered\",\"textStyle\":\"body\",\"userDefinedListNumber\":8}",
      "blocks": [],
      "updated": 1687532293038
    },
    {
      "id": "AF331448-F903-41E6-B5D7-9BC1560F2C04",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "执行加法操作，结果保存在eax寄存器中",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293036,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"numbered\",\"textStyle\":\"body\",\"userDefinedListNumber\":5}",
      "blocks": [],
      "updated": 1687532293036
    },
    {
      "id": "AF85754D-D7FA-4E36-B769-E50CBB71A555",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "任何时候引用类型都分配在heap中，在stack中只是保存对象的引用地址。Run函数执行完毕之后，heap中的MyClass1对象c成为可回收的垃圾对象，在GC时进行回收。",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293042,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293042
    },
    {
      "id": "B7FA0025-A482-40EA-9EC0-6A12A3A86C60",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "static void Main(string[] args)\n{\n    int r = Sum(2, 3, 4, 5, 6);\n}\nprivate static int Sum(int a, int b, int c, int d, int e)\n{\n    return a + b + c + d + e;\n}",
      "rawProperties": "{\"language\":\"cs\"}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293026,
      "type": "code",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "pluginData": "{\"horizontalSizeClass\":\"regular\",\"pluginConfigurationData\":\"{\\\"themeId\\\":\\\"\\\"}\",\"pluginName\":\"codeBlock\",\"surfaceShadowOpacity\":0,\"verticalSizeClass\":\"regular\"}",
      "updated": 1687574278233
    },
    {
      "id": "CAEE52D1-4156-449C-A627-F7CFEADB58BB",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "每个线程对应一个stack，线程创建的时候CLR为其创建这个stack，stack主要作用是记录函数的执行情况。值类型变量（函数的参数、局部变量 等非成员变量）都分配在stack中，引用类型的对象分配在heap中，在stack中保存heap对象的引用指针。GC只负责heap对象的释放，heap内存空间管理。",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293021,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293021
    },
    {
      "id": "D42F5058-DD19-4293-A799-2AD8795C89E3",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "Stack状态变化过程：",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293032,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293032
    },
    {
      "id": "E1755B82-6379-4510-9723-287697FD2B5C",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "Stack结构",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293023,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"subtitle\"}",
      "blocks": [],
      "updated": 1687532293023
    },
    {
      "id": "E7B010DC-684F-4452-9E74-6B99EDE523D1",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "C#-内存管理_Stack和Heap【Area】",
      "pageStyleData": "{\"background\":{\"size\":\"full\",\"solidColor\":\"#f7f9f7\",\"type\":\"solid\"},\"isMirrored\":true,\"pageWidthType\":\"true\",\"styleId\":\"luki\"}",
      "rawProperties": "{\"coverImageEnabled\":\"false\",\"hasBeenPagifiedBefore\":\"1\"}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532290886,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"pageRegular\"}",
      "blocks": [
        "CAEE52D1-4156-449C-A627-F7CFEADB58BB",
        "2162905F-EEF3-4713-8EAB-3C493DEBAAF8",
        "95DE32D7-F128-4C49-A33E-43CD0A852B02",
        "E1755B82-6379-4510-9723-287697FD2B5C",
        "1FAB7768-991E-407E-9FC3-B5BA58998D85",
        "533E5402-9EDD-4B50-AE26-AAFFF4CD9147",
        "B7FA0025-A482-40EA-9EC0-6A12A3A86C60",
        "27CB311C-AC50-441B-BDBD-80FAD6B46E1E",
        "046D82E5-D432-451A-9037-464322FD79BB",
        "F0D26F4B-E899-4425-8A90-E2E4F00831FD",
        "0D56D8B2-C4A7-4335-9004-1028BCFF021E",
        "D42F5058-DD19-4293-A799-2AD8795C89E3",
        "58756F7D-A7E9-40DF-8C15-763C04069956",
        "8C9B843D-9624-4281-95A9-FF1E310DC3E1",
        "FBACF8D9-F470-462D-88E3-4AD6DBB294E6",
        "3F2AAA4E-2865-499C-89D6-F717DB76F620",
        "AF331448-F903-41E6-B5D7-9BC1560F2C04",
        "46DB2ED5-11DC-4BE4-8BDB-661564BA78F2",
        "F4D970CA-A6A6-497F-A757-22611DC31990",
        "9D20A542-ACFA-400E-BBF7-F12656A279DA",
        "034F4D6C-1818-4ADC-987B-74EB2D0C7B68",
        "F783F6CF-B2C2-41F8-91DF-C96055244FCA",
        "4CE46333-8704-4841-BBEF-DE3C14C7091D",
        "0E4343E5-56CB-446C-88B2-963AFBCD0A6B",
        "11E7D047-9327-4997-B7A4-F54B76DBE797",
        "AF85754D-D7FA-4E36-B769-E50CBB71A555"
      ],
      "pageStyleProps": "{\"color\":\"#1F2225 #F4F4F4\",\"backdrop\":\"#f7f9f7 #f7f9f7\",\"theme-id\":\"3C07060B-6733-42A8-B033-C8EC0A19272D\",\"card-assets\":\"none\",\"font-family\":\"system\",\"page-width-type\":\"true\",\"separator-style\":\"line\",\"background-color\":\"#FFFFFF #222222\"}",
      "updated": 1750335525378
    },
    {
      "id": "F0D26F4B-E899-4425-8A90-E2E4F00831FD",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "执行时刻的stack状态如下（栈基地址为高端地址，栈顶为低端地址）：",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293030,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293030
    },
    {
      "id": "F4D970CA-A6A6-497F-A757-22611DC31990",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "原始ebp的值出栈，恢复ebp，这样栈完全恢复到进入Sum函数调用时的状态",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293037,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"numbered\",\"textStyle\":\"body\",\"userDefinedListNumber\":7}",
      "blocks": [],
      "updated": 1687532293037
    },
    {
      "id": "F783F6CF-B2C2-41F8-91DF-C96055244FCA",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "结合引用类型变量、值类型的ref参数，下面代码简化的stack状态如下：",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293039,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"none\",\"textStyle\":\"body\"}",
      "blocks": [],
      "updated": 1687532293039
    },
    {
      "id": "FBACF8D9-F470-462D-88E3-4AD6DBB294E6",
      "documentId": "6017C0BD-8454-4BB9-9E9A-3F8D5B8D0ECA",
      "content": "函数Sum先将寄存器ebp压栈保存，并将esp放入ebp，用于后面对参数和局部变量寻址",
      "rawProperties": "{}",
      "createdByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "modifiedByUserId": "ff47392e-1b37-dd92-268a-2c80735d18e1",
      "created": 1687532293035,
      "type": "text",
      "style": "{\"_runAttributes\":[],\"decorations\":{},\"decorationStyles\":{},\"indentationLevel\":0,\"listStyle\":\"numbered\",\"textStyle\":\"body\",\"userDefinedListNumber\":3}",
      "blocks": [],
      "updated": 1687532293035
    }
  ],
  "inheritedPageStyle": {
    "pageWidthType": "true",
    "background": {
      "size": "full",
      "solidColor": "#f7f9f7",
      "type": "solid"
    },
    "styleId": "luki",
    "header": {}
  },
  "inheritedPageStyleProps": {
    "color": "#1F2225 #F4F4F4",
    "backdrop": "#f7f9f7 #f7f9f7",
    "theme-id": "3C07060B-6733-42A8-B033-C8EC0A19272D",
    "card-assets": "none",
    "font-family": "system",
    "page-width-type": "true",
    "separator-style": "line",
    "background-color": "#FFFFFF #222222"
  },
  "rootBlockId": "E7B010DC-684F-4452-9E74-6B99EDE523D1",
  "settings": {
    "documentAppearance": "default",
    "hiddenLogo": false,
    "freeTier": false,
    "teamId": "e5336d46-6f5f-1acd-7266-4d0fefce8055",
    "forceSwitches": {}
  },
  "features": {
    "enabled": [
      "fs-show-title",
      "fs-enable-column-view"
    ],
    "disabled": [
      "fs-add-comment",
      "fs-view-comment",
      "fs-object-links",
      "fs-show-author",
      "fs-show-custom-logo",
      "fs-show-duplicate-as-template",
      "fs-hide-logo",
      "fs-hide-table-of-contents",
      "fs-hide-presentation-mode"
    ]
  }
}