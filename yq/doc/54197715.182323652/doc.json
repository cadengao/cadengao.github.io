{
  "uuid": "54197715.182323652",
  "id": 182323652,
  "title": "Modbus-RTU通信模式【Area】",
  "cover": "",
  "book_id": 54197715,
  "book_name": "Area",
  "public": 0,
  "word_count": 1821,
  "created_at": "2024-08-15T03:15:23",
  "updated_at": "2024-08-17T03:31:00",
  "body_html": "<!doctype html><div class=\"lake-content\" typography=\"classic\"><h1 id=\"oBWMK\"><span class=\"ne-text\">通信格式</span></h1><p id=\"ua79c501e\" class=\"ne-p\"><span class=\"ne-text\">RTU模式下，每一个字符传送格式，在该模式下发送一个字符需要11位二进制。</span></p><table id=\"bnOeY\" class=\"ne-table\" style=\"width: 750px\"><tbody><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u7d35c061\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">位</span></strong></p></td><td width=\"375\"><p id=\"udcd46ba1\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">说明</span></strong></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u2fca1516\" class=\"ne-p\"><span class=\"ne-text\">起始位</span></p></td><td width=\"375\"><p id=\"u4e7a5150\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u2bb2aef0\" class=\"ne-p\"><span class=\"ne-text\">数据</span></p></td><td width=\"375\"><p id=\"ucee7f767\" class=\"ne-p\"><span class=\"ne-text\">数据长度8位，低位先发送</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"uc8a4adef\" class=\"ne-p\"><span class=\"ne-text\">校验位</span></p></td><td width=\"375\"><p id=\"u1dcfa083\" class=\"ne-p\"><span class=\"ne-text\">1位(有校验)，0位(无校验)</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u62a1890d\" class=\"ne-p\"><span class=\"ne-text\">停止位</span></p></td><td width=\"375\"><p id=\"uaf6b7cf1\" class=\"ne-p\"><span class=\"ne-text\">1位(有校验)，2位(无校验)</span></p></td></tr><tr style=\"height: 33px\"><td width=\"375\"><p id=\"u5438350f\" class=\"ne-p\"><span class=\"ne-text\">波特率</span></p></td><td width=\"375\"><p id=\"ua15cf5d6\" class=\"ne-p\"><span class=\"ne-text\">用户自选选</span></p></td></tr></tbody></table><h1 id=\"Mfnjx\"><span class=\"ne-text\">数据格式</span></h1><h2 id=\"F9qGA\"><span class=\"ne-text\">帧结构</span></h2><div class=\"ne-quote\"><p id=\"u1515522f\" class=\"ne-p\"><span class=\"ne-text\" style=\"background-color: #F1A2AB\">帧结构 = 起始位(1位) + </span><strong><span class=\"ne-text\" style=\"background-color: #F1A2AB\">地址码(1位)</span></strong><span class=\"ne-text\" style=\"background-color: #F1A2AB\"> + </span><strong><span class=\"ne-text\" style=\"background-color: #F1A2AB\">功能码(1位)</span></strong><span class=\"ne-text\" style=\"background-color: #F1A2AB\"> + </span><strong><span class=\"ne-text\" style=\"background-color: #F1A2AB\">数据域(n位)</span></strong><span class=\"ne-text\" style=\"background-color: #F1A2AB\"> + </span><strong><span class=\"ne-text\" style=\"background-color: #F1A2AB\">校验码(2位)</span></strong><span class=\"ne-text\" style=\"background-color: #F1A2AB\"> + </span><strong><span class=\"ne-text\" style=\"background-color: #F1A2AB\">结束位(1位)</span></strong></p></div><ul class=\"ne-ul\"><li id=\"u5576e333\" data-lake-index-type=\"0\"><strong><span class=\"ne-text\">起始位</span></strong><span class=\"ne-text\">：一般为1位，用于标记数据帧开始。</span></li></ul><ul class=\"ne-ul\"><li id=\"u1af74bfb\" data-lake-index-type=\"0\"><strong><span class=\"ne-text\">地址码</span></strong><span class=\"ne-text\">:  用于指示设备的地址，占用一个字节，范围0-255，其中有效范围是1-247，其他有特殊用途，比如255是广播地址(广播地址就是应答所有地址，正常的需要两个设备的地址一样才能进行查询和回复)。</span></li></ul><ul class=\"ne-ul\"><li id=\"u029e9a0f\" data-lake-index-type=\"0\"><strong><span class=\"ne-text\">功能码</span></strong><span class=\"ne-text\">：占用一个字节，功能码的意义就是用于指示数据帧的类型，知道这个指令是干啥的，比如你可以查询从机的数据，也可以修改数据，所以不同功能码对应不同功能。常用的功能码有读取线圈状态、读取离散输入状态、读取保持寄存器、读取输入寄存器等。</span></li></ul><ul class=\"ne-ul\"><li id=\"u31ddaf7e\" data-lake-index-type=\"0\"><strong><span class=\"ne-text\">数据域</span></strong><span class=\"ne-text\">：包含数据信息，长度不定，取决于功能码和数据内容，根据功能码不同，有不同结构，。</span></li></ul><ul class=\"ne-ul\"><li id=\"uee5ec8c4\" data-lake-index-type=\"0\"><strong><span class=\"ne-text\">校验码</span></strong><span class=\"ne-text\">：包括两个字节，用于检验数据的正确性，通常采用CRC校验。为了保证数据不错误，增加这个,然后再把前面的数据进行计算看数据是否一致，如果一致，就说明这帧数据是正确的，我再回复；如果不一样，说明你这个数据在传输的时候出了问题，数据不对的，所以就抛弃了。</span></li></ul><ul class=\"ne-ul\"><li id=\"ud273bcc0\" data-lake-index-type=\"0\"><span class=\"ne-text\">结束位：一般为1位，用于标记数据帧结束。</span></li></ul><table id=\"qCmdy\" class=\"ne-table\" style=\"width: 750px\"><tbody><tr style=\"height: 33px\"><td width=\"125\"><p id=\"ubfabbd1a\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">起始码</span></strong></p></td><td width=\"125\"><p id=\"u37ceb13f\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">地址码</span></strong></p></td><td width=\"125\"><p id=\"u23ccdad3\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">功能码</span></strong></p></td><td width=\"125\"><p id=\"u7bd878e0\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">数据区</span></strong></p></td><td width=\"125\"><p id=\"u115853e2\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">校验码</span></strong></p></td><td width=\"125\"><p id=\"u7aec23ad\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">停止码</span></strong></p></td></tr><tr style=\"height: 33px\"><td width=\"125\"><p id=\"u179ce0b6\" class=\"ne-p\"><span class=\"ne-text\">至少3.5字符间隔时间</span></p></td><td width=\"125\"><p id=\"u80261d38\" class=\"ne-p\"><span class=\"ne-text\">01-F7</span></p></td><td width=\"125\"><p id=\"ud940defd\" class=\"ne-p\"><span class=\"ne-text\">功能码</span></p></td><td width=\"125\"><p id=\"u8af42f37\" class=\"ne-p\"><span class=\"ne-text\">0-252字节</span></p></td><td width=\"125\"><p id=\"ue552cd95\" class=\"ne-p\"><span class=\"ne-text\">CRC</span></p></td><td width=\"125\"><p id=\"uc55f5de1\" class=\"ne-p\"><span class=\"ne-text\">至少3.5字符间隔时间</span></p></td></tr><tr style=\"height: 33px\"><td width=\"125\"><p id=\"u3ac4a9e3\" class=\"ne-p\"><span class=\"ne-text\">间隔时间</span></p></td><td width=\"125\"><p id=\"uad130a79\" class=\"ne-p\"><span class=\"ne-text\">1字节</span></p></td><td width=\"125\"><p id=\"uc03b39db\" class=\"ne-p\"><span class=\"ne-text\">1字节</span></p></td><td width=\"125\"><p id=\"u8f1cc767\" class=\"ne-p\"><span class=\"ne-text\">0-252字节</span></p></td><td width=\"125\"><p id=\"u3ef4acbc\" class=\"ne-p\"><span class=\"ne-text\">2字节(先发校验码低八位再发高八位)</span></p></td><td width=\"125\"><p id=\"ue6cb8461\" class=\"ne-p\"><span class=\"ne-text\">间隔时间</span></p></td></tr></tbody></table><h2 id=\"Lmidi\"><span class=\"ne-text\">报文解析</span></h2><ol class=\"ne-ol\"><li id=\"u33e1184d\" data-lake-index-type=\"0\"><span class=\"ne-text\">读取线圈状态</span></li></ol><p id=\"u992f8777\" class=\"ne-p\"><span class=\"ne-text\">例如：01 01 00 00 00 08 44 18</span></p><table id=\"uMKkG\" class=\"ne-table\" style=\"width: 749px\"><tbody><tr style=\"height: 33px\"><td width=\"107\"><p id=\"ufe62086a\" class=\"ne-p\"><br></p></td><td width=\"107\"><p id=\"u1dad392e\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">起始位</span></strong></p></td><td width=\"107\"><p id=\"u8be62c7f\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">地址码</span></strong></p></td><td width=\"107\"><p id=\"u9e6159b0\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">功能码</span></strong></p></td><td width=\"107\"><p id=\"u14ef62d8\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">数据域</span></strong></p></td><td width=\"107\"><p id=\"ua30612eb\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">校验码</span></strong></p></td><td width=\"107\"><p id=\"u0c64002e\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">结束位</span></strong></p></td></tr><tr style=\"height: 33px\"><td width=\"107\"><p id=\"ucfca71bc\" class=\"ne-p\"><br></p></td><td width=\"107\"><p id=\"uf40b9547\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td><td width=\"107\"><p id=\"u17a86710\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td><td width=\"107\"><p id=\"uff8027b7\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td><td width=\"107\"><p id=\"u396d26a6\" class=\"ne-p\"><span class=\"ne-text\">2位</span></p></td><td width=\"107\"><p id=\"ub95c2108\" class=\"ne-p\"><span class=\"ne-text\">2位</span></p></td><td width=\"107\"><p id=\"ud54958eb\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td></tr><tr style=\"height: 33px\"><td width=\"107\"><p id=\"u9113c069\" class=\"ne-p\"><span class=\"ne-text\">解析：</span></p></td><td width=\"107\"><p id=\"u2a8d1e2e\" class=\"ne-p\"><span class=\"ne-text\">1</span></p></td><td width=\"107\"><p id=\"uc36b8a02\" class=\"ne-p\"><span class=\"ne-text\">01</span></p></td><td width=\"107\"><p id=\"ue3ba1752\" class=\"ne-p\"><span class=\"ne-text\">01</span></p></td><td width=\"107\"><p id=\"u54eb40ee\" class=\"ne-p\"><span class=\"ne-text\">00 00</span><span class=\"ne-text\"><br /></span><span class=\"ne-text\">00 08</span></p></td><td width=\"107\"><p id=\"u2b3f38b9\" class=\"ne-p\"><span class=\"ne-text\">44 18</span></p></td><td width=\"107\"><p id=\"u7543a552\" class=\"ne-p\"><span class=\"ne-text\">1</span></p></td></tr></tbody></table><p id=\"u119eeaf4\" class=\"ne-p\"><span class=\"ne-text\">解析：起始位为1，地址码为01，功能码为01(读取线圈状态)，数据域为00 00(起始地址)、00 08(线圈数量)，校验码为44 18，结束位为1。</span></p><ol class=\"ne-ol\"><li id=\"u9569c913\" data-lake-index-type=\"0\"><span class=\"ne-text\">读取保持寄存器</span></li></ol><p id=\"uf755ca36\" class=\"ne-p\"><span class=\"ne-text\">例如：01 03 00 00 00 02 C4 0B</span></p><table id=\"tTO9X\" class=\"ne-table\" style=\"width: 749px\"><tbody><tr style=\"height: 33px\"><td width=\"107\"><p id=\"ub58e25bd\" class=\"ne-p\"><br></p></td><td width=\"107\"><p id=\"u588b3353\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">起始位</span></strong></p></td><td width=\"107\"><p id=\"u5e783262\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">地址码</span></strong></p></td><td width=\"107\"><p id=\"uef7cae58\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">功能码</span></strong></p></td><td width=\"107\"><p id=\"uba49583e\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">数据域</span></strong></p></td><td width=\"107\"><p id=\"uf58bad95\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">校验码</span></strong></p></td><td width=\"107\"><p id=\"ufb26d375\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">结束位</span></strong></p></td></tr><tr style=\"height: 33px\"><td width=\"107\"><p id=\"uda4d639b\" class=\"ne-p\"><br></p></td><td width=\"107\"><p id=\"ud1721fda\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td><td width=\"107\"><p id=\"u4f0acc34\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td><td width=\"107\"><p id=\"u3088d794\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td><td width=\"107\"><p id=\"ub2143991\" class=\"ne-p\"><span class=\"ne-text\">2位</span></p></td><td width=\"107\"><p id=\"u995b361f\" class=\"ne-p\"><span class=\"ne-text\">2位</span></p></td><td width=\"107\"><p id=\"ubdf51766\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td></tr><tr style=\"height: 33px\"><td width=\"107\"><p id=\"ud505777f\" class=\"ne-p\"><span class=\"ne-text\">解析：</span></p></td><td width=\"107\"><p id=\"u466d5f31\" class=\"ne-p\"><span class=\"ne-text\">1</span></p></td><td width=\"107\"><p id=\"u3d257599\" class=\"ne-p\"><span class=\"ne-text\">01</span></p></td><td width=\"107\"><p id=\"u0b2096bc\" class=\"ne-p\"><span class=\"ne-text\">03</span></p></td><td width=\"107\"><p id=\"u0109778e\" class=\"ne-p\"><span class=\"ne-text\">00 00</span><span class=\"ne-text\"><br /></span><span class=\"ne-text\">00 02</span></p></td><td width=\"107\"><p id=\"u6b870268\" class=\"ne-p\"><span class=\"ne-text\">C4 0B</span></p></td><td width=\"107\"><p id=\"ud987ff34\" class=\"ne-p\"><span class=\"ne-text\">1</span></p></td></tr></tbody></table><p id=\"uff394be3\" class=\"ne-p\"><span class=\"ne-text\">解析：起始位为1，地址码为01，功能码为03(读取保持寄存器)，数据域为00 00(起始地址)、00 02(寄存器数量)，校验码为C4 0B，结束位为1。</span></p><ol class=\"ne-ol\"><li id=\"u59105731\" data-lake-index-type=\"0\"><span class=\"ne-text\">写入单个线圈</span></li></ol><p id=\"u43d8a4a5\" class=\"ne-p\"><span class=\"ne-text\">例如：01 05 00 06 FF 00 8C 3A</span></p><table id=\"tfJta\" class=\"ne-table\" style=\"width: 749px\"><tbody><tr style=\"height: 33px\"><td width=\"107\"><p id=\"u91d43b6c\" class=\"ne-p\"><br></p></td><td width=\"107\"><p id=\"ube4efe82\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">起始位</span></strong></p></td><td width=\"107\"><p id=\"u4839b006\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">地址码</span></strong></p></td><td width=\"107\"><p id=\"u4aa90105\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">功能码</span></strong></p></td><td width=\"107\"><p id=\"uc57ad24c\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">数据域</span></strong></p></td><td width=\"107\"><p id=\"u0cca8445\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">校验码</span></strong></p></td><td width=\"107\"><p id=\"ud6685213\" class=\"ne-p\"><strong><span class=\"ne-text\" style=\"background-color: #FBDE28\">结束位</span></strong></p></td></tr><tr style=\"height: 33px\"><td width=\"107\"><p id=\"ufb80b857\" class=\"ne-p\"><br></p></td><td width=\"107\"><p id=\"u26450f7f\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td><td width=\"107\"><p id=\"udfacea68\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td><td width=\"107\"><p id=\"u2afeee99\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td><td width=\"107\"><p id=\"u0fc88d2d\" class=\"ne-p\"><span class=\"ne-text\">2位</span></p></td><td width=\"107\"><p id=\"u3d56f04b\" class=\"ne-p\"><span class=\"ne-text\">2位</span></p></td><td width=\"107\"><p id=\"uf918461d\" class=\"ne-p\"><span class=\"ne-text\">1位</span></p></td></tr><tr style=\"height: 33px\"><td width=\"107\"><p id=\"ua10be4b6\" class=\"ne-p\"><span class=\"ne-text\">解析：</span></p></td><td width=\"107\"><p id=\"u2dc6ca1b\" class=\"ne-p\"><span class=\"ne-text\">1</span></p></td><td width=\"107\"><p id=\"u811f5ee7\" class=\"ne-p\"><span class=\"ne-text\">01</span></p></td><td width=\"107\"><p id=\"ua7a3d587\" class=\"ne-p\"><span class=\"ne-text\">05</span></p></td><td width=\"107\"><p id=\"uaf134664\" class=\"ne-p\"><span class=\"ne-text\">00 06 </span><span class=\"ne-text\"><br /></span><span class=\"ne-text\">FF 00</span></p></td><td width=\"107\"><p id=\"uf782c017\" class=\"ne-p\"><span class=\"ne-text\">8C 3A</span></p></td><td width=\"107\"><p id=\"uce2df463\" class=\"ne-p\"><span class=\"ne-text\">1</span></p></td></tr></tbody></table><p id=\"u2d7b0c48\" class=\"ne-p\"><span class=\"ne-text\">解析：起始位为1，地址码为01，功能码为05(写入单个线圈)，数据域为00 06(线圈地址)、FF 00(写入值)，校验码为8C 3A，结束位为1。</span></p><h1 id=\"RkIF3\"><span class=\"ne-text\">CRC</span></h1><p id=\"ubba4cf58\" class=\"ne-p\"><span class=\"ne-text\">循环冗余校验(Cyclic Redundancy Check， CRC)是一种根据网络数据包或计算机文件等数据产生简短固定位数校验码的一种信道编码技术，主要用来检测或校验数据传输或者保存后可能出现的错误。它是利用除法及余数的原理来作错误侦测的。</span></p><p id=\"u90546854\" class=\"ne-p\"><span class=\"ne-text\">在这里只说明modbus rtu 模式中 CRC 计算步骤。</span></p><p id=\"u1fecb534\" class=\"ne-p\"><span class=\"ne-text\">校验的范围：</span><strong><span class=\"ne-text\" style=\"color: #DF2A3F\">从地址码到数据区所有数据</span></strong><span class=\"ne-text\" style=\"color: #DF2A3F\">。</span></p><p id=\"u3aa94bba\" class=\"ne-p\"><span class=\"ne-text\">计算CRC码的步骤为：</span><span class=\"ne-text\" style=\"color: #DF2A3F\">异或</span><span class=\"ne-text\">：相同为0，不同为1</span></p><ol class=\"ne-ol\"><li id=\"u2cce2f48\" data-lake-index-type=\"0\"><span class=\"ne-text\">预置16位寄存器为十六进制FFFF(11111111 11111111)。称此寄存器为CRC寄存器；</span></li></ol><ol start=\"2\" class=\"ne-ol\"><li id=\"uc8a474e4\" data-lake-index-type=\"0\"><span class=\"ne-text\">把第一个8位数据与16位CRC寄存器的低位相异或，把结果放于CRC寄存器；</span></li></ol><ol start=\"3\" class=\"ne-ol\"><li id=\"u7edcdf5b\" data-lake-index-type=\"0\"><span class=\"ne-text\">把寄存器的内容右移一位(朝低位)，用0填补最高位，检查最低位；</span></li></ol><ol start=\"4\" class=\"ne-ol\"><li id=\"u4f0854fb\" data-lake-index-type=\"0\"><span class=\"ne-text\">如果最低位为0：重复第3步(再次移位);</span></li></ol><ol start=\"5\" class=\"ne-ol\"><li id=\"ufbf69614\" data-lake-index-type=\"0\"><span class=\"ne-text\">如果最低位为1：CRC寄存器与多项式A001(1010 0000 0000 0001)进行异或；</span></li></ol><ol start=\"6\" class=\"ne-ol\"><li id=\"u1c0db357\" data-lake-index-type=\"0\"><span class=\"ne-text\">重复步骤3和4，直到右移8次，这样整个8位数据全部进行了处理；</span></li></ol><ol start=\"7\" class=\"ne-ol\"><li id=\"u4d956db0\" data-lake-index-type=\"0\"><span class=\"ne-text\">重复步骤2到步骤5，进行下一个8位数据的处理；</span></li></ol><ol start=\"8\" class=\"ne-ol\"><li id=\"u0fc32866\" data-lake-index-type=\"0\"><span class=\"ne-text\">最后得到的CRC寄存器即为CRC码。</span></li></ol><ol start=\"9\" class=\"ne-ol\"><li id=\"uee09889e\" data-lake-index-type=\"0\"><span class=\"ne-text\">将高低字节互换得到modbus CRC。</span></li></ol><h2 id=\"TERX5\"><span class=\"ne-text\">示例代码C#</span></h2><pre data-language=\"csharp\" id=\"nadgJ\" class=\"ne-codeblock language-csharp\"><code>//假设我们要计算的数据为{0x01, 0x02, 0x03, 0x04}：\n//1. 预处理：01 02 03 04\n//2. 初始化：CRC = 0xFFFF\n//3. 计算：\n//    - 处理01：CRC = CRC xor 01，得到 0xFFFE\n//    - 处理02：CRC = CRC xor 02，得到 0xFFFC\n//    - 处理03：CRC = CRC xor 03，得到 0xFFF8\n//    - 处理04：CRC = CRC xor 04，得到 0xFFF0\n//4. 反转：将CRC值的高位和低位进行反转，得到校验值为0xF0FF。\n\npublic static ushort CalculateCrc(byte[] data)\n{\n    ushort crc = 0xFFFF;\n    for (int i = 0; i &lt; data.Length; i++)\n    {\n        crc ^= data[i];\n        for (int j = 0; j &lt; 8; j++)\n        {\n            if ((crc &amp; 0x0001) != 0)\n            {\n                crc &gt;&gt;= 1;\n                crc ^= 0xA001;\n            }\n            else\n            {\n                crc &gt;&gt;= 1;\n            }\n        }\n    }\n    crc = (ushort)((crc &lt;&lt; 8) | (crc &gt;&gt; 8));\n    return crc;\n}</code></pre><h2 id=\"Ab7WF\"><span class=\"ne-text\">示例代码C：</span></h2><pre data-language=\"cpp\" id=\"UbaWv\" class=\"ne-codeblock language-cpp\"><code>//下面是一个示例，假设要计算的数据为0x01 0x02 0x03 0x04，那么CRC校验码的计算过程如下：\n//1. 初始化寄存器为0xFFFF。\n//2. 将0x01放入寄存器中，进行运算，得到寄存器的值为0xC5C8。\n//3. 将0x02放入寄存器中，进行运算，得到寄存器的值为0x8D4F。\n//4. 将0x03放入寄存器中，进行运算，得到寄存器的值为0x402A。\n//5. 将0x04放入寄存器中，进行运算，得到寄存器的值为0x28CB。\n//6. 最终寄存器的值为0x28CB，即为CRC校验码。\n\n#include &lt;stdint.h&gt;\n\nuint16_t crc_table[256] = {\n    0x0000, 0x1189, 0x2312, 0x329B, 0x4624, 0x57AD, 0x6536, 0x74BF,\n    0x8C48, 0x9DC1, 0xAF5A, 0xBED3, 0xCA6C, 0xDBE5, 0xE97E, 0xF8F7,\n    // 省略部分代码\n};\n\nuint16_t crc16(uint8_t *data, uint16_t length) {\n    uint16_t crc = 0xFFFF;\n    for (int i = 0; i &lt; length; i++) {\n        uint8_t index = (crc ^ data[i]) &amp; 0xFF;\n        crc = (crc &gt;&gt; 8) ^ crc_table[index];\n    }\n    return crc;\n}</code></pre></div>"
}